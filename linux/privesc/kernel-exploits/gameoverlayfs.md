---
description: CVE-2023-2640 & CVE-2023-32629
---

# GameOverlayFs

## Theory

CVE-2023-2640 and CVE-2023-32629 were found in the OverlayFS module in Ubuntu, which is a widely used Linux filesystem that became highly popular with the rise of containers as its features enable the deployment of dynamic filesystems based on pre-built images. The two vulnerabilities are **exclusive to Ubuntu** because Ubuntu introduced several changes to the OverlayFS module in 2018.

These flaws allow the creation of specialized executables, which, upon execution, grant the ability to escalate privileges to root on the affected machine. Linux has a feature called "file capabilities" that grants elevated privileges to executables while they're executed. This feature is reserved for the root user, while lower-privileged users cannot create such files. However, we discovered that it's possible to craft an executable file with “scoped” file capabilities and trick the Ubuntu kernel into copying it to a different location with “unscoped” capabilities, granting anyone who executes it root-like privileges.

## Practice

{% tabs %}
{% tab title="Enumerate" %}
The target system is likely to be vulnerable if its an **Ubuntu** and has a kernel version **lower than 6.2 and greater than 5.15**.

```bash
#Get Kernel version
$ uname -r
5.15.70-051570-generic
```

Following versions are vulnerable (marked with a ✔):

<table><thead><tr><th width="219">Release</th><th width="94">Version</th><th width="192">CVE-2023-2640</th><th>CVE-2023-32629</th></tr></thead><tbody><tr><td>Ubuntu 23.04 (Lunar Lobster)</td><td></td><td></td><td></td></tr><tr><td></td><td>6.2.0</td><td>✔</td><td>✔</td></tr><tr><td>Ubuntu 22.10 (Kinetic Kudu)</td><td></td><td></td><td></td></tr><tr><td></td><td>5.19.0</td><td>✔</td><td>✔</td></tr><tr><td>Ubuntu 22.04 LTS (Jammy Jellyfish)</td><td></td><td></td><td></td></tr><tr><td></td><td>5.19.0</td><td>✔</td><td>✔</td></tr><tr><td></td><td>6.2.0</td><td>✔</td><td>✔</td></tr><tr><td></td><td>5.15.0</td><td>✘</td><td>✘</td></tr><tr><td>Ubuntu 20.04 LTS (Focal Fossa)</td><td></td><td></td><td></td></tr><tr><td></td><td>5.15.0</td><td>✘</td><td>✘</td></tr><tr><td></td><td>5.4.0</td><td>✘</td><td>✔</td></tr><tr><td>Ubuntu 18.04 LTS (Bionic Beaver)</td><td></td><td></td><td></td></tr><tr><td></td><td>5.4.0</td><td>✘</td><td>✔</td></tr></tbody></table>
{% endtab %}

{% tab title="Exploit" %}
Using [this exploit](https://github.com/luanoliveira350/GameOverlayFS) from luanoliveira350, we can abuse GameoverlayFS

```bash
# Just run it !
chmod +x gameoverlay.sh
./gameoverlay.sh
```

{% hint style="info" %}
Don't forget to edit the command you want to run in the gameoverlay.sh script.
{% endhint %}
{% endtab %}
{% endtabs %}

## Resources

{% embed url="https://www.wiz.io/blog/ubuntu-overlayfs-vulnerability" %}
